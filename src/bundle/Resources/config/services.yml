services:
    MateuszBieniek\EzPlatformDatabaseHealthChecker\Persistence\Legacy\Content\Gateway\DoctrineDatabase:
        arguments:
            $connection: '@ibexa.persistence.connection'
            $contentGateway: '@ibexa.persistence.legacy.content.gateway.inner'
            $locationGateway: '@ibexa.persistence.legacy.location.gateway'
            $fieldHandler: '@ibexa.persistence.legacy.field_handler'

    MateuszBieniek\EzPlatformDatabaseHealthChecker\Persistence\Legacy\Content\Gateway\PageFieldTypeDoctrineDatabase:
        arguments:
            $connection: '@ibexa.persistence.connection'
            $pageFieldTypeGateway: '@?EzSystems\EzPlatformPageFieldType\FieldType\Page\Storage\DoctrineGateway'

    MateuszBieniek\EzPlatformDatabaseHealthCheckerBundle\Command\DatabaseHealthCheckCommand:
        arguments:
            $contentGateway: '@MateuszBieniek\EzPlatformDatabaseHealthChecker\Persistence\Legacy\Content\Gateway\DoctrineDatabase'
            $contentService: '@ibexa.api.service.content'
            $locationService: '@ibexa.api.service.location'
            $siteAccess: '@ibexa.siteaccess'
            $permissionResolver: '@eZ\Publish\API\Repository\PermissionResolver'
            $handler: '@ibexa.api.storage_engine'
            $repository: '@ibexa.api.repository'
        tags:
            - { name: 'console.command', command: 'ezplatform:database-health-check' }

    MateuszBieniek\EzPlatformDatabaseHealthCheckerBundle\Command\PageFieldTypeCleanupCommand:
        arguments:
            $gateway: '@MateuszBieniek\EzPlatformDatabaseHealthChecker\Persistence\Legacy\Content\Gateway\PageFieldTypeDoctrineDatabase'
            $repository: '@ibexa.api.repository'
        tags:
            - { name: 'console.command', command: 'ezplatform:page-fieldtype-cleanup' }

    cache.null:
        class: Symfony\Component\Cache\Adapter\NullAdapter
        arguments: [~]
        tags:
            - name: cache.pool
              clearer: cache.app_clearer
              namespace: '%cache_namespace%'
